## タイトル

レコードの先頭または末尾の列が`-`のみで構成される値だとフォーマット結果が不正。

## 概要

以下の状態で`TableFormat`を実行する。

```
| id | name |
| -- | ---- |
| aa | - |
```

### 期待値

```
| id | name |
| -- | ---- |
| aa | -    |
```

### 実際

```
| id | name |
| 
```

### 補足

**ハイフン以外の記号**
```
| id | name |
| -- | ---- |
| aa | +    |
```

**端のカラム以外がハイフン**
```
| id   | name | note |
| ---- | ---- | ---- |
| hoge | -    | hoge |
```

とかなら問題ない。また、ハイフン1つではなく2つ以上でも事象は再現する。恐らく2行目のセパレーターに関する処理で問題が起こっていると思う。


## ステータス

クローズ

## 作業記録

### 👤 Claude Code 2025/07/02 16:17:16

ISSUE-8の修正を開始しました。

### 👤 Claude Code 2025/07/02 16:17:16

問題の根本原因を特定しました：
- `parser.lua`の`is_separator_line`関数（67行目）の正規表現 `^|?%s*[-:]+%s*|.*$` が、`| aa | - |` のようなデータ行の末尾セル `- |` 部分にマッチしてしまい、セパレーター行として誤判定していた。

修正アプローチ：
1. セルレベルでの詳細な分析を行う新しいロジックに変更
2. 全てのセルがハイフン・コロンのみで構成されているかをチェック
3. 空セルや通常のデータが含まれるセルがあればデータ行として判定

### 👤 Claude Code 2025/07/02 16:17:16

修正を完了しました：
- `parser.lua`の`is_separator_line`関数を完全に書き換え
- ISSUE-8専用のテストケースを`parser_spec.lua`と`e2e_spec.lua`に追加
- 全テスト60個が通過することを確認
- StyLuaフォーマットも適用済み

修正内容：
- 従来の正規表現ベースの判定を廃止
- テーブル行として解析後、各セルを個別に検査する方式に変更
- セパレーター行は全セルがハイフン・コロンのみの場合のみ判定

テストケース：
- `| aa | - |` → データ行として正しく判定
- `| - | bb |` → データ行として正しく判定  
- `| aa | -- |` → データ行として正しく判定
- `| -- | ---- |` → セパレーター行として正しく判定

